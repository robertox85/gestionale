{% extends 'base.html.twig' %}

{% block content %}

    <div class="mb-4 border-b border-gray-200 dark:border-gray-700">
        <ul class="flex flex-wrap -mb-px text-sm font-medium text-center" id="myTab" data-tabs-toggle="#myTabContent"
            role="tablist">
            <li class="mr-2" role="presentation">
                <button class="inline-block p-4 border-b-2 rounded-t-lg" id="ruoli-tab" data-tabs-target="#ruoli"
                        type="button" role="tab" aria-controls="ruoli" aria-selected="false">
                    Ruoli
                </button>
            </li>


        </ul>
    </div>
    <div id="myTabContent">

        <div class="hidden p-4 rounded-lg bg-gray-50 dark:bg-gray-800" id="ruoli" role="tabpanel"
             aria-labelledby="profile-tab">

            <!-- Assegna Permessi -->
            <form method="get" action="{{ url('impostazioni') }}">
                <div class="flex flex-wrap -mx-3 mb-6">
                    <div class="w-full px-3">
                        <label class="block mb-2 text-xs font-bold tracking-wide text-gray-700 uppercase"
                               for="grid-password">
                            Ruolo
                        </label>
                        <select onchange="this.form.submit()" name="ruolo"
                                class="block w-full px-4 py-3 pr-8 leading-tight text-gray-700 bg-white border border-gray-200 rounded shadow appearance-none focus:outline-none focus:shadow-outline">

                            <option value="" selected disabled>Seleziona un ruolo</option>
                            {% for ruolo in ruoli %}
                                <option value="{{ ruolo.id }}" {% if ruoloSelezionato and ruoloSelezionato.id == ruolo.id %} selected {% endif %}>{{ ruolo.name }}</option>
                            {% endfor %}
                        </select>


                    </div>
                </div>
            </form>

            <form action="{{ url('impostazioni/aggiornaRuolo') }}" method="post">

                <input type="hidden" name="id_ruolo" value="{% if ruoloSelezionato %}{{ ruoloSelezionato.id }}{% endif %}">
                <input type="hidden" name="csrf_token" value="{{ csrf_token('aggiornaRuolo') }}">

                <div class="flex flex-wrap -mx-3 mb-6">
                    <div class="w-full px-3">
                        <label class="block mb-2 text-sm font-bold text-gray-700 uppercase" for="grid-password">
                            Permessi
                        </label>
                        <div class="flex flex-wrap -mx-2">
                            {% for permesso in permessi %}
                                <div class="w-full sm:w-1/2 md:w-1/3 lg:w-1/4 xl:w-1/6 px-2 mb-3">
                                    <label class="inline-flex items-center w-full cursor-pointer">

                                        <input
                                                {% if ruoloSelezionato %}
                                                    {% for permission in ruoloSelezionato.permissions %}
                                                        {{ permission.id_permesso }}
                                                        {% if permission.id_permesso == permesso.id_permesso %}
                                                            checked
                                                        {% endif %}
                                                    {% endfor %}
                                                {% endif %}

                                                type="checkbox" class="form-checkbox text-blue-500" name="permessi[]"
                                               value="{{ permesso.id_permesso }}">
                                        <span class="ml-2 text-gray-800">
                                            {{ permesso.descrizione_permesso }}
                                        </span>
                                    </label>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>


                <div class="flex flex-wrap -mx-3 mb-6">
                    <div class="w-full px-3">
                        <button
                                class="px-4 py-2 font-bold text-white bg-blue-500 rounded hover:bg-blue-700 focus:outline-none focus:shadow-outline"
                                type="submit">
                            Salva
                        </button>
                    </div>
                </div>

            </form>
        </div>

    </div>

{% endblock %}